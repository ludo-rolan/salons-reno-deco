!function(t,e,n,a){"use strict";var s=function(t){var e,n,a;for(n=1;n<arguments.length;n++){e=arguments[n];for(a in e)e.hasOwnProperty(a)&&(t[a]=e[a])}return t},o=function(t,e,n){var a,s,o=Object.prototype.toString.call(e),r=function(t,e,n){if(t.addEventListener)t.addEventListener(e,n);else if(t.on)t.on(e,n);else{if(!t.attachEvent)throw new Error("object has no mechanism for adding event listeners");t.attachEvent("on"+e,n)}};switch(o){case"[object String]":r(t,e,n);break;case"[object Array]":for(a=0,s=e.length;a<s;a++)r(t,e[a],n);break;case"[object Object]":for(a in e)e.hasOwnProperty(a)&&r(t,a,e[a]);break;default:throw new Error("Unrecognized events parameter type: "+o)}return t},r=function(e){return(t.setImmediate||t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.setTimeout)(e,0)},i=function(e){return(t.clearImmediate||t.cancelAnimationFrame||t.webkitCancelAnimationFrame||t.mozCancelAnimationFrame||t.clearTimeout)(e)},c=function(t){t.ads.cancelPlayTimeout||(t.ads.cancelPlayTimeout=r(function(){t.ads.cancelPlayTimeout=null,t.paused()||t.pause(),t.one("contentplayback",function(){t.paused()&&t.play()})}))},d=function(t){var e,n,a=t.el().querySelector(".vjs-tech"),s=t.remoteTextTracks?t.remoteTextTracks():[],o=[],r={ended:t.ended(),src:t.currentSrc(),currentTime:t.currentTime(),type:t.currentType()};for(a&&(r.nativePoster=a.poster,r.style=a.getAttribute("style")),n=s.length;n--;)e=s[n],o.push({track:e,mode:e.mode}),e.mode="disabled";return r.suppressedTracks=o,r},u=function(t,e){for(var n=t.className.split(/\s+/),a=n.length,s=[];a--;)n[a]!==e&&s.push(n[a]);t.className=s.join(" ")},l=function(e,n){var a,s=e.el().querySelector(".vjs-tech"),o=20,r=n.suppressedTracks,i=function(){for(var t=r.length;t--;)(a=r[t]).track.mode=a.mode},c=function(){var a=!1,s=function(){a=!0};e.currentTime(n.currentTime),n.ended?(t.setTimeout(function(){a||e.play(),e.off("ended",s)},250),e.on("ended",s)):e.play()},d=function(){return s.readyState>1?c():void 0===s.seekable?c():s.seekable.length>0?c():void(o--?setTimeout(d,50):function(){try{c()}catch(t){videojs.log.warn("Failed to resume the content after an advertisement",t)}}())};n.nativePoster&&(s.poster=n.nativePoster),"style"in n&&s.setAttribute("style",n.style||""),(e.src()?e.src()!==n.src:e.currentSrc()!==n.src)?(e.one("contentloadedmetadata",i),e.src({src:n.src,type:n.type}),e.load(),e.one("contentcanplay",d)):e.ended()&&n.ended||(i(),e.play())},p=function(t){var e=t.el().querySelector(".vjs-tech");e&&e.removeAttribute("poster")},f={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1};n.plugin("ads",function(e){var a,y=this,m=s({},f,e||{});!function(){var t,e=videojs.Html5.Events,n=function(){return!0},a=function(t,e){e.isImmediatePropagationStopped=n,e.cancelBubble=!0,e.isPropagationStopped=n,y.trigger({type:t+e.type,state:y.ads.state,originalEvent:e})},s=function(t){if("ad-playback"===y.ads.state)a("ad",t);else if("content-playback"===y.ads.state&&"ended"===t.type)a("content",t);else if("content-resuming"===y.ads.state){if(y.ads.snapshot){if(y.currentSrc()!==y.ads.snapshot.src){if("loadstart"===t.type)return;return a("content",t)}if(y.ads.snapshot.ended)return"pause"===t.type||"ended"===t.type?void y.addClass("vjs-has-started"):a("content",t)}"playing"!==t.type&&a("content",t)}};for(e.push("firstplay"),e.push("loadedalldata"),t=e.length;t--;)y.on(e[t],s)}(),y.on(["addurationchange","adcanplay"],function(){var t=y.ads.snapshot;y.currentSrc()!==t.src&&y.play()}),y.ads={state:"content-set",startLinearAdMode:function(){"ad-playback"!==y.ads.state&&y.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===y.ads.state&&y.trigger("adend")},skipLinearAdMode:function(){"ad-playback"!==y.ads.state&&y.trigger("adskip")}},a=function(e){var n={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",c(y),p(y)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",c(y)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){y.el().className+=" vjs-ad-loading",y.ads.timeout=t.setTimeout(function(){y.trigger("adtimeout")},m.prerollTimeout),y.trigger("readyforpreroll")},leave:function(){t.clearTimeout(y.ads.timeout),u(y.el(),"vjs-ad-loading")},events:{play:function(){c(y)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){y.el().className+=" vjs-ad-loading",y.ads.timeout=t.setTimeout(function(){y.trigger("adtimeout")},m.timeout)},leave:function(){t.clearTimeout(y.ads.timeout),u(y.el(),"vjs-ad-loading")},events:{play:function(){c(y)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){this.snapshot=d(y),y.el().className+=" vjs-ad-playing",p(y),y.ads.cancelPlayTimeout&&(i(y.ads.cancelPlayTimeout),y.ads.cancelPlayTimeout=null)},leave:function(){u(y.el(),"vjs-ad-playing"),l(y,this.snapshot),"adend"!==y.ads.triggerevent&&y.trigger("adend")},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming"}}},"content-resuming":{enter:function(){this.snapshot.ended&&(t.clearTimeout(y.ads._fireEndedTimeout),y.ads._fireEndedTimeout=t.setTimeout(function(){y.trigger("ended")},1e3))},leave:function(){t.clearTimeout(y.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=d(y),y.el().className+=" vjs-ad-loading",y.ads.timeout=t.setTimeout(function(){y.trigger("adtimeout")},m.postrollTimeout)},leave:function(){t.clearTimeout(y.ads.timeout),u(y.el(),"vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming",r(function(){y.trigger("ended")})},adtimeout:function(){this.state="content-resuming",r(function(){y.trigger("ended")})},adserror:function(){this.state="content-resuming",r(function(){y.trigger("ended")})}}},"content-playback":{enter:function(){y.ads.cancelPlayTimeout&&(i(y.ads.cancelPlayTimeout),y.ads.cancelPlayTimeout=null),y.trigger({type:"contentplayback",triggerevent:y.ads.triggerevent})},events:{adsready:function(){y.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback"},contentupdate:function(){y.paused()?this.state="content-set":this.state="ads-ready?"},contentended:function(){this.state="postroll?"}}}};!function(t){var a=function(){};((n[t].events||{})[e.type]||a).apply(y.ads),t!==y.ads.state&&(y.ads.triggerevent=e.type,(n[t].leave||a).apply(y.ads),(n[y.ads.state].enter||a).apply(y.ads),m.debug&&videojs.log("ads",y.ads.triggerevent+" triggered: "+t+" -> "+y.ads.state))}(y.ads.state)},o(y,n.Html5.Events.concat(["adtimeout","contentupdate","contentplaying","contentended","adsready","adserror","adscanceled","adstart","adend","adskip"]),a),y.ads.contentSrc=y.currentSrc(),function(){var t=function(){var t;"ad-playback"!==y.ads.state&&(t=y.currentSrc())!==y.ads.contentSrc&&(y.trigger({type:"contentupdate",oldValue:y.ads.contentSrc,newValue:t}),y.ads.contentSrc=t)};y.on(["loadstart"],t),r(t)}(),y.paused()||a({type:"play"})})}(window,document,videojs);